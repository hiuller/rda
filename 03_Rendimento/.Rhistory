data2<- read.csv("./data/aaca2.csv")
names(data2)[20] <- "rend.new"
old.par <- par()
lm.dt3   <-lm(data2$rend.old ~ data2$sagp.t + data2$sint.t              + data2$ligas.t + data2$tacb.t + data2$esc.t)
summary(lm.dt3)
ad.test(lm.dt3$residuals)
require(car)
ad.test(lm.dt3$residuals)
library(car)
ad.test(lm.dt3$residuals)
?ad.test
??ad.test
library(nortest)
ad.test(lm.dt3$residuals)
jan.14 <- c(1, 40.73,	1.847,	11.1890646,	26.85,	18.63295393, 0.8959)
names(jan.14) <- c("one",  "sagp.t",	"sint.t",	"ligas.t",	"tacb.t",	"esc.t", "rend")
rend.hat.jan <- t(lm.dt4$coefficients)%*%jan.14[1:6]
rend.jan <- jan.14[7]
# goodness of the last linear model
plot(data2$rend.old ~ lm.dt3$fitted.values, pch=19, col="blue", cex=1.2, xlim=c(0.8, 0.915), ylim=c(0.8, 0.915))
abline(h=aicNew$coefficients[1], col="darkgrey")
abline(a=0, b=1, col="red", lwd=1)
text(x=0.813, y=0.855, label=paste("Intercepto=", round(lm.dt3$coefficients[1],4)))
title(paste("Rendimento x previsto modelo 3: r^2=", round(cor(data2$rend.old, lm.dt3$fitted.values)^2,2)))
points(rend.jan, rend.hat.jan, col="red", pch=19, cex=1.2)
abline(lm.dt3$coefficients[1], col="darkgrey")
dev.off()
plot(data2$rend.old ~ lm.dt3$fitted.values, pch=19, col="blue", cex=1.2, xlim=c(0.8, 0.915), ylim=c(0.8, 0.915))
plot(data2$rend.old ~ lm.dt3$fitted.values, pch=19, col="blue", cex=1.2, xlim=c(0.8, 1), ylim=c(0.8, 1))
abline(lm.dt3$coefficients[1], col="darkgrey")
abline(coef=lm.dt3$coefficients[1], col="darkgrey")
abline(reg=lm.dt3$coefficients[1], col="darkgrey")
abline(reg=lm.dt3$coefficients[1], col="darkgrey")
abline(a=0, b=1, col="red", lwd=1)
title(paste("Rendimento x previsto modelo 3: r^2=", round(cor(data2$rend.old, lm.dt3$fitted.values)^2,2)))
points(rend.jan, rend.hat.jan, col="red", pch=19, cex=1.2)
rend.hat.jan <- t(lm.dt4$coefficients)%*%jan.14[1:6]
jan.14 <- c(1, 40.73,	1.847,	11.1890646,	26.85,	18.63295393, 0.8959)
names(jan.14) <- c("one",  "sagp.t",	"sint.t",	"ligas.t",	"tacb.t",	"esc.t", "rend")
rend.hat.jan <- t(lm.dt4$coefficients)%*%jan.14[1:6]
rend.hat.jan <- t(lm.dt3$coefficients)%*%jan.14[1:6]
rend.jan <- jan.14[7]
dev.off()
plot(data2$rend.old ~ lm.dt3$fitted.values, pch=19, col="blue", cex=1.2, xlim=c(0.8, 1), ylim=c(0.8, 1))
abline(reg=lm.dt3$coefficients[1], col="darkgrey")
abline(a=0, b=1, col="red", lwd=1)
title(paste("Rendimento x previsto modelo 3: r^2=", round(cor(data2$rend.old, lm.dt3$fitted.values)^2,2)))
points(rend.jan, rend.hat.jan, col="red", pch=19, cex=1.2)
plot(data2$rend.old ~ lm.dt3$fitted.values, pch=19, col="blue", cex=1.2)#, xlim=c(0.8, 1), ylim=c(0.8, 1))
abline(reg=lm.dt3$coefficients[1], col="darkgrey")
abline(a=0, b=1, col="red", lwd=1)
title(paste("Rendimento x previsto modelo 3: r^2=", round(cor(data2$rend.old, lm.dt3$fitted.values)^2,2)))
points(rend.jan, rend.hat.jan, col="red", pch=19, cex=1.2)
summary(lm.dt3)
aicNew <- step(lm.dt3)
summary(aicNew)
plot(data2$rend.old ~ data2$periodo, pch=19, col="blue", cex=1.2)
lines(data2$rend.old ~ data2$periodo, type="l", lwd=2, col="blue", cex=1.2)
points(data2$rend.new ~ data2$periodo, pch=19, col="red", cex=1.2)
lines(data2$rend.new ~ data2$periodo, type="l", lwd=2, col="red",  cex=1.2)
points(data2$rend.cb.esc ~ data2$periodo, pch=19, col="green", cex=1.2)
lines(data2$rend.cb.esc~ data2$periodo, type="l", lwd=2, col="green",  cex=1.2)
summary(lm.dt3)
plot(data2$rend.new ~ aicNew$fitted.values, pch=19, col="blue", cex=1.2, xlim=c(0.86, 0.915), ylim=c(0.86, 0.96))
plot(data2$rend.old ~ lm.dt3$fitted.values, pch=19, col="blue", cex=1.2, xlim=c(0.89, 0.96), ylim=c(0.86, 0.96))
plot(data2$rend.old ~ lm.dt3$fitted.values, pch=19, col="blue", cex=1.2, xlim=c(0.89, 0.95), ylim=c(0.86, 0.95))
abline(a=0, b=1, col="red", lwd=1)
title(paste("Rendimento x previsto modelo 3: r^2=", round(cor(data2$rend.old, lm.dt3$fitted.values)^2,2)))
points(rend.jan, rend.hat.jan, col="red", pch=19, cex=1.5)
plot(data2$rend.old ~ lm.dt3$fitted.values, pch=19, col="blue", cex=1.2, xlim=c(0.89, 0.95), ylim=c(0.89, 0.95))
plot(data2$rend.old ~ lm.dt3$fitted.values, pch=19, col="blue", cex=1.2, xlim=c(0.86, 0.95), ylim=c(0.86, 0.95))
plot(data2$rend.old ~ lm.dt3$fitted.values, pch=19, col="blue", cex=1.2, xlim=c(0.88, 0.95), ylim=c(0.88, 0.95))
abline(reg=lm.dt3$coefficients[1], col="darkgrey")
lines(reg=lm.dt3$coefficients[1], col="darkgrey")
abline(a=0, b=1, col="red", lwd=1)
text(x=0.813, y=0.855, label=paste("Intercepto=", round(lm.dt3$coefficients[1],4)))
title(paste("Rendimento x previsto modelo 3: r^2=", round(cor(data2$rend.old, lm.dt3$fitted.values)^2,2)))
points(rend.jan, rend.hat.jan, col="red", pch=19, cex=1.5)
plot(lm.dt3$residuals, pch=19, col="blue", cex=1.1)
lines(lm.dt3$residuals, type="l", col="blue", lwd=1.5, cex=1.1)
abline(a=0, b=0, col="darkgrey", lwd=2)
title("Residuals of lm.dt3")
resid.jan <- rend.jan - rend.hat.jan
points(res)
points(x=6, y=resid.jan, col="red", cex=1.5)
points(x=6, y=resid.jan, col="red", pch=19, cex=1.5)
plot(data2$rend.old ~ data2$periodo, pch=19, col="blue", cex=1.2, xlim=c(0, 13))
lines(data2$rend.old ~ data2$periodo, type="l", lwd=2, col="blue", cex=1.2)
points(data2$rend.new ~ data2$periodo, pch=19, col="red", cex=1.2)
lines(data2$rend.new ~ data2$periodo, type="l", lwd=2, col="red",  cex=1.2)
points(data2$rend.cb.esc ~ data2$periodo, pch=19, col="green", cex=1.2)
lines(data2$rend.cb.esc~ data2$periodo, type="l", lwd=2, col="green",  cex=1.2)
points(x=6, y=resid.jan, col="red", pch=19, cex=1.5)
plot(lm.dt3$residuals, pch=19, col="blue", cex=1.1, xlim=c(0,13))
lines(lm.dt3$residuals, type="l", col="blue", lwd=1.5, cex=1.1)
abline(a=0, b=0, col="darkgrey", lwd=2)
title("Residuals of lm.dt3")
points(x=13, y=resid.jan, col="red", pch=19, cex=1.5)
text(x=13, y=resid.jan-0.01, label="jan/14")
text(x=13, y=-0.04, label="jan/14")
text(x=13, y=-0.04, labels="jan/14")
text(labels="jan/14")
text(x=13, labels="jan/14")
text(x=13, labels="jan")
text(x=12, y=-0.04, labels="jan")
?mtext
text(locator(1), labels="jan")
text(locator(1), labels="jan/14")
plot(lm.dt3$residuals, pch=19, col="blue", cex=1.1, xlim=c(0,13))
lines(lm.dt3$residuals, type="l", col="blue", lwd=1.5, cex=1.1)
abline(a=0, b=0, col="darkgrey", lwd=2)
title("Residuals of lm.dt3")
points(x=13, y=resid.jan, col="red", pch=19, cex=1.5)
text(locator(1), labels="jan/14")
plot(lm.dt3$residuals, pch=19, col="blue", cex=1.1, xlim=c(0,13))
lines(lm.dt3$residuals, type="l", col="blue", lwd=1.5, cex=1.1)
abline(a=0, b=0, col="darkgrey", lwd=2)
title("Residuals of lm.dt3")
points(x=13, y=resid.jan, col="red", pch=19, cex=1.5)
text(locator(1), labels="jan/14")
plot(lm.dt3$residuals, pch=19, col="blue", cex=1.1, xlim=c(0,13))
lines(lm.dt3$residuals, type="l", col="blue", lwd=1.5, cex=1.1)
abline(a=0, b=0, col="grey", lwd=1, lty="dashed")
title("Residuals of lm.dt3")
points(x=13, y=resid.jan, col="red", pch=19, cex=1.5)
text(locator(1), labels="jan/14")
pos <- locator(1)
pos
locator(1)
plot(lm.dt3$residuals, pch=19, col="blue", cex=1.1, xlim=c(0,13))
lines(lm.dt3$residuals, type="l", col="blue", lwd=1.5, cex=1.1)
abline(a=0, b=0, col="grey", lwd=1, lty="dashed")
title("Residuals of lm.dt3")
points(x=13, y=resid.jan, col="red", pch=19, cex=1.5)
text(x=13.0, y=-0.0038, labels="jan/14")
legend(locator(1))
legend(locator(1), legend=c("2013", "2014"))
legend(locator(1), legend=c("2013", "2014"), col=c("blue","red"))
summary(lm.dt3)
plot(data2$rend.old ~ periodos, pch=19, col="blue", cex=1.2)
who
ls
rm
rm()
cls
ws()
getws()
periodos <- c("jan", "fev", "mar", "abr", "mai", "jun", "jul", "ago", "set", "out", "nov", "dez")
plot(data2$rend.old ~ periodos, pch=19, col="blue", cex=1.2)
plot(data2$rend.old,xlab=periodos, pch=19, col="blue", cex=1.2)
plot(data2$rend.old,x=periodos, pch=19, col="blue", cex=1.2)
plot(data2$rend.old, type="b", pch=19, col="blue", cex=1.2, labels=periodos)
lines(data2$rend.old, type="l", lwd=2, col="blue", cex=1.2)
points(data2$rend.new, pch=19, col="red", cex=1.2)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
dev.off()
plot(data2$rend.old, type="b", pch=19, col="blue", cex=1.2, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
plot(data2$rend.old, type="b", pch=19, col="blue", cex=1.2)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
plot(data2$rend.old, type="b", pch=19, col="blue", labels=periodos, cex=1.2)
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", labels=periodos, cex=1.2)
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013")#, labels=periodos, cex=1.2)
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2)
dev.off()
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2)
axis(1, 1:12, labels=periodos)
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.8, 0.95))
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.85, 0.95))
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("Oficial", "Sem CB", "Sem CB e escoria"), col=c("blue", "red", "green"), ncol=2, bty="n", cex=0.8, inset=0.01)
legend("topright", legend=c("Oficial", "Sem CB", "Sem CB e escoria"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=2, bty="n", cex=0.8, inset=0.01)
dev.off()
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.85, 0.95))
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("Oficial", "Sem CB", "Sem CB e escoria"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=2, bty="n", cex=0.8, inset=0.01)
legend("topright", legend=c("Oficial", "Sem CB", "Sem CB e escoria"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=0.8, inset=0.01)
dev.off()
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.85, 0.95))
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("Oficial", "Sem CB", "Sem CB e escoria"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=0.8, inset=0.01)
dev.off()
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.85, 0.95), ylab="Rendimento")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("Oficial", "Sem CB", "Sem CB e escoria"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=0.8, inset=0.01)
legend("topright", legend=c("Oficial", "Sem CB", "Sem CB e escoria"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=0.8, inset=0.01, pch=21)
plot(data2$rend.new ~ aicNew$fitted.values, pch=19, col="blue", cex=1.2, xlim=c(0.86, 0.915), ylim=c(0.86, 0.96))
abline(h=aicNew$coefficients[1], col="darkgrey")
abline(a=0, b=1, col="red", lwd=1)
text(x=0.813, y=0.855, label=paste("Intercepto=", round(aicNew$coefficients[1],4)))
title("Rendimento sem CB x previsto modelo (sinter e ligas)")
plot(data2$rend.old ~ aicNew$fitted.values, pch=19, col="blue", cex=1.2, xlim=c(0.86, 0.915), ylim=c(0.86, 0.96))
abline(h=aicNew$coefficients[1], col="darkgrey")
abline(a=0, b=1, col="red", lwd=1)
text(x=0.813, y=0.855, label=paste("Intercepto=", round(aicNew$coefficients[1],4)))
title("Rendimento sem CB x previsto modelo (sinter e ligas)")
plot(data2$rend.new ~data2$ligas.t, pch=19, col="red", cex=1.1)
abline(coef=lm(data2$rend.new ~data2$ligas.t)$coefficients, pch=2)
title("Rendimento sem CB e ligas (kg/t")
plot(data2$rend.new ~data2$sint.t,  pch=19, col="red", cex=1.1)
abline(coef=lm(data2$rend.new ~data2$sint.t)$coefficients, pch=2)
title("Rendimento sem CB e sinter (kg/t")
plot(data2$rend.old ~ data2$esc.t, pch=19, col="red", cex=1.2)
mean(data2$rend.new)
plot(aicFormula$residuals, pch=19, col="red", cex=1.2)
plot(lm.dt2$fitted.values ~data2$rend, pch=19, cex=1.5, col="blue", ylab="Rendimento (modelo)", xlab="Rendimento (Real)")
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.86, 0.95), ylab="Rendimento")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("Oficial", "Sem CB", "Sem CB e escoria"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=0.8, inset=0.01, pch=21)
legend("topright", legend=c("Oficial", "Sem CB", "Sem CB e escoria"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.2, inset=0.01, pch=21)
dev.off()
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.86, 0.95), ylab="Rendimento")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("Oficial", "Sem CB", "Sem CB e escoria"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.2, inset=0.01, pch=21)
legend("topright", legend=c("Oficial", "Sem CB", "Sem CB e escoria"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.2, inset=0.01, pch=19)
dev.off()
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.86, 0.95), ylab="Rendimento")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("(a)", "(b)", "(c)"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.1, inset=0.01, pch=19)
legend("topright", legend=c("(a)", "(b)", "(c)"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.1, inset=0.05, pch=19)
dev.off()
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.86, 0.95), ylab="Rendimento")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("(a)", "(b)", "(c)"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.1, inset=0.05, pch=19)
pdf("latex/figures/fig09.pdf", height=4, width=6)
par(mfcol=c(1,1), mai=rep(0.5, 4), oma=c(1,1,1,1), mar=c(5,4,2,2)+0.1)#, xpd=NA) #c(bottom, left, top, right)
par(mar=c(5,4,2,2)+0.1) # this is a no-title margin
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.86, 0.95), ylab="Rendimento")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("(a)", "(b)", "(c)"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.1, inset=0.05, pch=19)
dev.off()
pdf("latex/figures/fig09.pdf", height=4, width=6)
par(mfcol=c(1,1), mai=rep(0.5, 4), oma=c(1,1,1,1), mar=c(5,4,2,2)+0.1)#, xpd=NA) #c(bottom, left, top, right)
par(mar=c(1,1,1,1)+0.1) # this is a no-title margin
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.86, 0.95), ylab="Rendimento")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("(a)", "(b)", "(c)"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.1, inset=0.05, pch=19)
dev.off()
pdf("latex/figures/fig09.pdf", height=4, width=6)
par(mfcol=c(1,1), mai=rep(0.5, 4), oma=c(1,1,1,1), mar=c(5,4,2,2)+0.1)#, xpd=NA) #c(bottom, left, top, right)
par(mar=c(1,0.5,1,1)+0.1) # this is a no-title margin
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.86, 0.95), ylab="Rendimento")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("(a)", "(b)", "(c)"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.1, inset=0.05, pch=19)
dev.off()
pdf("latex/figures/fig09.pdf", height=4, width=6)
par(mfcol=c(1,1), mai=rep(0.5, 4), oma=c(1,1,1,1), mar=c(5,4,2,2)+0.1)#, xpd=NA) #c(bottom, left, top, right)
par(mar=c(1.5,1,0.5,0.5)+0.1) # this is a no-title margin
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.86, 0.95), ylab="Rendimento")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("(a)", "(b)", "(c)"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.1, inset=0.05, pch=19)
dev.off()
pdf("latex/figures/fig09.pdf", height=4, width=6)
par(mfcol=c(1,1), mai=rep(0.5, 4), oma=c(1,1,1,1), mar=c(5,4,2,2)+0.1)#, xpd=NA) #c(bottom, left, top, right)
par(mar=c(1.8,1.8,0,0)+0.1) # this is a no-title margin
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.86, 0.95), ylab="Rendimento")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("(a)", "(b)", "(c)"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.1, inset=0.05, pch=19)
dev.off()
pdf("latex/figures/fig09.pdf", height=4, width=6)
par(mfcol=c(1,1), mai=rep(0.5, 4), oma=c(1,1,1,1), mar=c(5,4,2,2)+0.1)#, xpd=NA) #c(bottom, left, top, right)
par(mar=c(2.2,2.2,0,0)+0.1) # this is a no-title margin
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.86, 0.95), ylab="Rendimento")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("(a)", "(b)", "(c)"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.1, inset=0.05, pch=19)
dev.off()
pdf("latex/figures/fig09.pdf", height=4, width=6)
par(mfcol=c(1,1), mai=rep(0.5, 4), oma=c(0.5,0.5,0.5,0.5))#, xpd=NA) #c(bottom, left, top, right)
par(mar=c(3,3,0,0)+0.1) # this is a no-title margin
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.86, 0.95), ylab="Rendimento")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("(a)", "(b)", "(c)"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.1, inset=0.05, pch=19)
dev.off()
source.with.encoding('~/.active-rstudio-document', encoding='UTF-8')
pdf("latex/figures/fig09.pdf", height=4, width=6)
par(mfcol=c(1,1), mai=rep(0.5, 4), oma=c(0.5,0.5,0.5,0.5))#, xpd=NA) #c(bottom, left, top, right)
par(mar=c(5,4,0,0)+0.1) # this is a no-title margin
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.86, 0.95), ylab="Rendimento")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("(a)", "(b)", "(c)"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.1, inset=0.05, pch=19)
dev.off()
pdf("latex/figures/fig09.pdf", height=4, width=6)
par(mfcol=c(1,1), mai=rep(0.5, 4), oma=c(0.5,0.5,0.5,0.5))#, xpd=NA) #c(bottom, left, top, right)
par(mar=c(4.2,4,0,0)+0.1) # this is a no-title margin
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.86, 0.95), ylab="Rendimento")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("(a)", "(b)", "(c)"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.1, inset=0.05, pch=19)
dev.off()
pdf("latex/figures/fig09.pdf", height=4, width=6)
par(mfcol=c(1,1), mai=rep(0.5, 4), oma=c(0.5,0.5,0.5,0.5))#, xpd=NA) #c(bottom, left, top, right)
par(mar=c(4,4,0,0)+0.1) # this is a no-title margin
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.86, 0.95), ylab="Rendimento")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("(a)", "(b)", "(c)"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.1, inset=0.05, pch=19)
dev.off()
pdf("latex/figures/fig09.pdf", height=4, width=6)
par(mfcol=c(1,1), mai=rep(0.5, 4), oma=c(0.5,0.5,0.5,0.5))#, xpd=NA) #c(bottom, left, top, right)
par(mar=c(3.8,3.8,0,0)+0.1) # this is a no-title margin
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.86, 0.95), ylab="Rendimento")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=19, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=19, col="green", cex=1.2)
legend("topright", legend=c("(a)", "(b)", "(c)"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.1, inset=0.05, pch=19)
dev.off()
pdf("latex/figures/fig09.pdf", height=4, width=6)
par(mfcol=c(1,1), mai=rep(0.5, 4), oma=c(0.5,0.5,0.5,0.5))#, xpd=NA) #c(bottom, left, top, right)
par(mar=c(3.8,3.8,0,0)+0.1) # this is a no-title margin
plot(data2$rend.old, type="b", pch=19, col="blue", xlab="2013", cex=1.2, xaxt="n", ylim=c(0.86, 0.95), ylab="Rendimento")
axis(1, 1:12, labels=periodos)
points(data2$rend.new, type="b", pch=17, col="red", cex=1.2)
points(data2$rend.cb.esc, type="b", pch=15, col="green", cex=1.2)
legend("topright", legend=c("(a)", "(b)", "(c)"), col=c("blue", "red", "green"), lty=1, lwd=2, ncol=1, bty="n", cex=1.1, inset=0.05, pch=c(19, 17, 15))
dev.off()
rm(list=ls())
setwd("C:/Users/Public/Documents/RDataAnalysis/03_Rendimento")
#data <- read.csv("./data/aaca.csv")
data2<- read.csv("./data/aaca2.csv")
names(data2)[20] <- "rend.new"
old.par <- par()
periodos <- c("jan", "fev", "mar", "abr", "mai", "jun", "jul", "ago", "set", "out", "nov", "dez")
plot(data2$.old ~data2$cao.t)
names(data2)
plot(data2$rend.old ~data2$cao.t)
plot(data2$rend.old ~data2$mgo.t)
pairs(rend.old ~ cao.t + mgo.t + rend.new + rend.cb.esc,data=data2, pch=19, col="red", cex=1.2)
#pairs(data$rend ~ data$gus.sol + data$pAA + data$sint.t + data$cb.t)
pairs(rend.old ~ cao.t + mgo.t + rend.new + rend.cb.esc,data=data2, pch=19, col="red", cex=1.8)
pairs(~ rend.old + cao.t + mgo.t + rend.new + rend.cb.esc,data=data2, pch=19, col="red", cex=1.8)
pairs(~ rend.old + cao.t + mgo.t + rend.new + rend.cb.esc,data=data2, pch=19, col="red", cex=1.8)
pairs(~ rend.old + cao.t + mgo.t,data=data2, pch=19, col="red", cex=1.8)
pairs(~ rend.new + cao.t + mgo.t,data=data2, pch=19, col="blue", cex=1.8)
pairs(~ rend.cb.esc + cao.t + mgo.t,data=data2, pch=19, col="green", cex=1.8)
lm.dt3   <-lm(data2$rend.old ~ data2$sagp.t + data2$sint.t + data2$pSuc + data2$ligas.t + data2$tacb.t + data2$esc.t + data2$cao.t + data2$mgo.t)
summary(lm.dt2)
summary(lm.dt3)
aic2 <- step(lm.dt3)
summary(aic2)
data2$camg.t <- data2$cao.t + data2$mgo.t
plot(data2$camg.t)
plot(data2$rend.old ~data2$camg.t)
lm.dt3   <-lm(data2$rend.old ~ data2$sagp.t + data2$sint.t + data2$pSuc + data2$ligas.t + data2$tacb.t + data2$esc.t + data2$cao.t + data2$mgo.t + data2$camg.t)
summary(lm.dt3)
lm.dt3   <-lm(data2$rend.old ~ data2$sagp.t + data2$sint.t + data2$pSuc + data2$ligas.t + data2$tacb.t + data2$esc.t + data2$camg.t)# + data2$cao.t + data2$mgo.t
summary(lm.dt3)
aic2 <- step(lm.dt3)
summary(lm.dt3)
lm.dt3   <-lm(data2$rend.old ~ data2$sagp.t + data2$sint.t + data2$pSuc + data2$ligas.t + data2$tacb.t + data2$esc.t + data2$cao.t + data2$mgo.t)
aic2 <- step(lm.dt3)
summary(lm.dt3)
plot(data2$rend.old ~ lm.dt3$fitted.values, pch=19, col="blue", cex=1.2, xlim=c(0.88, 0.95), ylim=c(0.88, 0.95))
abline(reg=lm.dt3$coefficients[1], col="darkgrey")
abline(a=0, b=1, col="red", lwd=1)
text(x=0.813, y=0.855, label=paste("Intercepto=", round(lm.dt3$coefficients[1],4)))
title(paste("Rendimento x previsto modelo 3: r^2=", round(cor(data2$rend.old, lm.dt3$fitted.values)^2,2)))
points(rend.jan, rend.hat.jan, col="red", pch=19, cex=1.5)
jan.14 <- c(1, 40.73,	1.847,	11.1890646,	26.85,	18.63295393, 0.8959)
names(jan.14) <- c("one",  "sagp.t",	"sint.t",	"ligas.t",	"tacb.t",	"esc.t", "rend")
rend.hat.jan <- t(lm.dt3$coefficients)%*%jan.14[1:6]
rend.jan <- jan.14[7]
resid.jan <- rend.jan - rend.hat.jan
plot(lm.dt3$residuals, pch=19, col="blue", cex=1.1, xlim=c(0,13))
lines(lm.dt3$residuals, type="l", col="blue", lwd=1.5, cex=1.1)
plot(lm.dt3$residuals, pch=19, lty="b", col="blue", cex=1.1, xlim=c(0,13))
plot(lm.dt3$residuals, pch=19, lty="b", col="blue", cex=1.1, xlim=c(0,13))
plot(lm.dt3$residuals, pch=19, type="b", col="blue", cex=1.1, xlim=c(0,13))
abline(a=0, b=0, col="grey", lwd=1, lty="dashed")
abline(a=0, b=0, col="grey", lwd=1, lty="dashed", cex=2)
plot(lm.dt3$residuals, pch=19, type="b", col="blue", cex=1.1, xlim=c(0,13))
abline(a=0, b=0, col="grey", lwd=1, lty="dashed", cex=2)
title("Residuals of lm.dt3")
points(x=13, y=resid.jan, col="red", pch=19, cex=1.5)
text(x=13.0, y=-0.0038, labels="jan/14")
legend(locator(1), legend=c("2013", "2014"), col=c("blue","red"))
legend("topright", inset=0.1, pch=19, legend=c("2013", "2014"), col=c("blue","red"))
legend("topright", inset=0.1, pch=19, lwd=2, legend=c("2013", "2014"), col=c("blue","red"))
legend("topright", inset=0.01, pch=19, lwd=2, legend=c("2013", "2014"), col=c("blue","red"))
legend("topright", inset=0.03, pch=19, lwd=2, legend=c("2013", "2014"), col=c("blue","red"))
plot(lm.dt3$residuals, pch=19, type="b", col="blue", cex=1.1, xlim=c(0,13))
abline(a=0, b=0, col="grey", lwd=1, lty="dashed", cex=2)
title("Residuals of lm.dt3")
points(x=13, y=resid.jan, col="red", pch=19, cex=1.5)
text(x=13.0, y=-0.0038, labels="jan/14")
legend("topright", inset=0.03, pch=19, lwd=2, legend=c("2013", "2014"), col=c("blue","red"))
legend("topright", inset=0.03, pch=19, lwd=2, legend=c("2013", "2014"), col=c("blue","red"), bty="n")
dev.off()
plot(lm.dt3$residuals, pch=19, type="b", col="blue", cex=1.1, xlim=c(0,13))
abline(a=0, b=0, col="grey", lwd=1, lty="dashed", cex=2)
title("Residuals of lm.dt3")
points(x=13, y=resid.jan, col="red", pch=19, cex=1.5)
text(x=13.0, y=-0.0038, labels="jan/14")
legend("topright", inset=0.03, pch=19, lwd=2, legend=c("2013", "2014"), col=c("blue","red"), bty="n")
locator(1)
dev.off()
plot(lm.dt3$residuals, pch=19, type="b", col="blue", cex=1.1, xlim=c(0,13))
abline(a=0, b=0, col="grey", lwd=1, lty="dashed", cex=2)
title("Residuals of lm.dt3")
points(x=13, y=resid.jan, col="red", pch=19, cex=1.5)
text(x=13.0, y=-0.0038, labels="jan/14")
legend("topright", inset=0.03, pch=19, lwd=2, legend=c("2013", "2014"), col=c("blue","red"), bty="n")
legend("topright", inset=0.03, pch=19, lwd=c(2, na), legend=c("2013", "2014"), col=c("blue","red"), bty="n")
legend("topright", inset=0.03, pch=19, lwd=c(2, na()), legend=c("2013", "2014"), col=c("blue","red"), bty="n")
legend("topright", inset=0.03, pch=19, lwd=c(2, 0), legend=c("2013", "2014"), col=c("blue","red"), bty="n")
dev.off()
plot(lm.dt3$residuals, pch=19, type="b", col="blue", cex=1.1, xlim=c(0,13))
abline(a=0, b=0, col="grey", lwd=1, lty="dashed", cex=2)
title("Residuals of lm.dt3")
points(x=13, y=resid.jan, col="red", pch=19, cex=1.5)
text(x=13.0, y=-0.0038, labels="jan/14")
legend("topright", inset=0.03, pch=19, lwd=c(2, 0), legend=c("2013", "2014"), col=c("blue","red"), bty="n")
plot(lm.dt3$residuals, pch=19, type="b", col="blue", cex=1.1, xlim=c(0,13))
abline(a=0, b=0, col="grey", lwd=1, lty="dashed", cex=2)
title("Residuals of lm.dt3")
points(x=13, y=resid.jan, col="red", pch=19, cex=1.5)
text(x=13.0, y=-0.0038, labels="jan/14")
legend("topright", inset=0.03, pch=19, lwd=c(2, NA), legend=c("2013", "2014"), col=c("blue","red"), bty="n")
plot(lm.dt3$residuals, pch=19, type="b", col="blue", cex=1.1, xlim=c(0,13))
abline(a=0, b=0, col="grey", lwd=1, lty="dashed", cex=2)
title("Residuals of lm.dt3")
points(x=13, y=resid.jan, col="red", pch=19, cex=1.5)
text(x=13.0, y=-0.0038, labels="jan/14")
legend("topright", inset=0.03, pch=19, type=c("b", NA), lwd=c(2, NA), legend=c("2013", "2014"), col=c("blue","red"), bty="n")
legend("topright", inset=0.03, pch=19, lwd=c(2, NA), legend=c("2013", "2014"), col=c("blue","red"), bty="n")
legend("topright", inset=0.03, pch=19, lwd=c(2, NA), legend=c("2013", "2014"), col=c("blue","red"), bty="n", cex=1.5)
dev.off()
plot(lm.dt3$residuals, pch=19, type="b", col="blue", cex=1.1, xlim=c(0,13))
abline(a=0, b=0, col="grey", lwd=1, lty="dashed", cex=2)
title("Residuals of lm.dt3")
points(x=13, y=resid.jan, col="red", pch=19, cex=1.5)
text(x=13.0, y=-0.0038, labels="jan/14")
legend("topright", inset=0.03, pch=19, lwd=c(2, NA), legend=c("2013", "2014"), col=c("blue","red"), bty="n", cex=1.3)
aicNew <- step(lm.dt3)
summary(aicNew)
plot(data2$rend.old ~ aicNew$fitted.values, pch=19, col="blue", cex=1.2, xlim=c(0.88, 0.95), ylim=c(0.88, 0.95))
abline(a=0, b=1, col="red", lwd=1)
points(data2$rend.old ~lm.dt3$fitted.values, pch=15, col="green", cex=1.2, xlim=c(0.88, 0.95), ylim=c(0.88, 0.95))
points(data2$rend.old ~lm.dt3$fitted.values, pch=19, col="green", cex=1.2, xlim=c(0.88, 0.95), ylim=c(0.88, 0.95))
dev.off()
plot(data2$rend.old ~ aicNew$fitted.values, pch=19, col="blue", cex=1.2, xlim=c(0.88, 0.95), ylim=c(0.88, 0.95))
points(data2$rend.old ~lm.dt3$fitted.values, pch=19, col="green", cex=1.2, xlim=c(0.88, 0.95), ylim=c(0.88, 0.95))
abline(a=0, b=1, col="red", lwd=1)
title("Comparisson between original and step model")
plot(data2$rend.old, type="b", col="blue", cex=1.2, xaxt="n")
plot(data2$rend.old, type="b", pch=19, col="blue", cex=1.2, xaxt="n")
axis(1, 1:12, labels=periodos)
lines(lm.dt3$fitted.values, type="b", pch=17, col="red", cex=1.2, xaxt="n")
lines(aicNew$fitted.values, type="b", pch=15, col="green", cex=1.2, xaxt="n")
legend("topleft", inset=0.05, pch=c(19,17,15), col=c("blue", "red", "green"), labels=c("Actual", "Original", "Step"), ncol=1)
legend("topleft", inset=0.05, pch=c(19,17,15), col=c("blue", "red", "green"), legend=c("Actual", "Original", "Step"), ncol=1)
plot(data2$rend.old, type="b", pch=19, col="blue", cex=1.2, xaxt="n")
axis(1, 1:12, labels=periodos)
lines(lm.dt3$fitted.values, type="b", pch=17, col="red", cex=1.2, xaxt="n")
lines(aicNew$fitted.values, type="b", pch=15, col="green", cex=1.2, xaxt="n")
legend("topright", inset=0.05, pch=c(19,17,15), col=c("blue", "red", "green"), legend=c("Actual", "Original", "Step"), ncol=1, bty="n")
plot(data2$rend.old, type="b", pch=19, col="blue", cex=1.2, xaxt="n")
axis(1, 1:12, labels=periodos)
lines(lm.dt3$fitted.values, type="b", pch=17, col="red", cex=1.2, xaxt="n")
lines(aicNew$fitted.values, type="b", pch=15, col="green", cex=1.2, xaxt="n")
legend("topright", inset=0.05, pch=c(19,17,15), col=c("blue", "red", "green"), legend=c("Actual", "Original", "Step"), ncol=1, bty="n", cex=1.2)
legend("topright", inset=0.05, pch=c(19,17,15), lwd=2, col=c("blue", "red", "green"), legend=c("Actual", "Original", "Step"), ncol=1, bty="n", cex=1.2)
plot(data2$rend.old, type="b", pch=19, col="blue", cex=1.2, xaxt="n")
axis(1, 1:12, labels=periodos)
lines(lm.dt3$fitted.values, type="b", pch=17, col="red", cex=1.2, xaxt="n")
lines(aicNew$fitted.values, type="b", pch=15, col="green", cex=1.2, xaxt="n")
legend("topright", inset=0.05, pch=c(19,17,15), lwd=2, col=c("blue", "red", "green"), legend=c("Actual", "Original", "Step"), ncol=1, bty="n", cex=1.2)
summary(aicNew)
q
q()
